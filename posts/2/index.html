
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <script src="/js/vendor/modernizr.js"></script>
  <meta charset="utf-8">
  <title>Blog | Evil Monkey Labs</title>
  <meta name="author" content="Brendan McAdams">

  
  <meta name="description" content="We&rsquo;re building a new intranet system at work, and I&rsquo;ve been toying with a few things that the Windows admin asked for. Namely, since the &hellip;">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.evilmonkeylabs.com/posts/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Evil Monkey Labs" type="application/atom+xml">

  <script src="/js/vendor/jquery.js"></script>
  <script src="/js/vendor/fastclick.js"></script>

  <script src="/js/foundation.min.js"></script>

  <script src="/javascripts/octopress.js" type="text/javascript"></script>


  <script>

  $(document).ready(function(){
    $(document).foundation();
  });

  </script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Roboto:300,300italic,500,500italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Ubuntu:500' rel='stylesheet' type='text/css'>

  

</head>

<body  >
  <header role="banner" class="top-header">
</header>
  <nav role="navigation"><ul class="subscription hide" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>


  <nav class="top-bar" data-topbar>

    <!--Uncomment Evil Monkey Labs below if you would like a title area on the left side of the nav bar-->

    <ul class="title-area">
        <li class="name">
          <h1><a href="/">Evil Monkey Labs <i class="fa fa-heart"></i></i></i></a></h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
    </ul>


    <section class="top-bar-section">

      <ul class="main-navigation right">

          <li><a href="/">Home</a></li>

          <li class="has-dropdown">
            <a href="/no-sidebar">No Sidebar Page</a>

            <ul class="dropdown">
              <li><a href="/no-sidebar/left-sidebar">Left Sidebar Page</a></li>
              <li><a href="/no-sidebar/right-sidebar">Right Sidebar Page</a></li>
              <li><a href="/no-sidebar/example-formatting">Example Formatting</a></li>
            </ul>

          </li>

          <li><a href="/blog/archives">Archives</a></li>

      </ul>

    </section>
  </nav>

</nav>
  <div id="main">
    <div id="content" class="row">
      <div class="small-12 medium-12 large-8 columns">
  
    <header class="page-header">
      <h1 class="page-title">Blog</h1>
      <h1 class="subheader">Optional Subtitle</h1>
    </header>
  
  <div class="blog-index">
    
    
    
      <article>
        
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/10/20/talking-to-activedirectory-from-iron-python/">Talking to ActiveDirectory From IronPython</a></h1>
    
    
      <p class="meta">
        








  


<i class="fa fa-calendar-o"></i> <time datetime="2009-10-20T00:00:00-04:00" pubdate data-updated="true">October 20, 2009</time> 
        
           | <a href="/blog/2009/10/20/talking-to-activedirectory-from-iron-python/#disqus_thread"
             data-disqus-identifier="http://blog.evilmonkeylabs.com/blog/2009/10/20/talking-to-activedirectory-from-iron-python/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We&rsquo;re building a new intranet system at work, and I&rsquo;ve been toying with a few things that the Windows admin asked for.  Namely, since the secretaries here will update the intranet data to add people&rsquo;s Work &amp; Emergency contact numbers, AIM handles, email addresses, etc. that we find a way to keep it all in sync with ActiveDirectory.  Thereby keeping all the Outlooks  and Blackberries up to date with the latest contact information.</p>

<p>This seemed like a fairly reasonable request, presuming we could figure out how to do it and since I&rsquo;ve been using Mono and IronPython a lot more lately, I figured there would be a way to accomplish it.  Most of the information I found online was either really old and/or crappy docs for doing it in C#, or more commonly using PowerShell or VBScript.  So, I managed to poke around and sort out how to get IronPython on Mono (IronPython 2.6RC + Mono 2.4.2.3) to find and update our users.</p>

<p>The end result is that I can now, from IronPython, find and update valid information on ActiveDirectory entries to reflect the latest and greatest information.  One thing to note, the MS .Net ActiveDirectory APIs (System.DirectoryServices, which is mirrored in Mono) do something that confused and annoyed me.  There are a limited set of &lsquo;valid&rsquo; attribute keys for a user object in Active Directory (Which is really just LDAP, in case you didn&rsquo;t know).  The <code>DirectoryEntry</code> object has a Properties attribute, which contains a hashmap of these values.</p>

</div>
  
  
    <footer>
      <a rel="full-article" class="button tiny radius" href="/blog/2009/10/20/talking-to-activedirectory-from-iron-python/">Read on &rarr;</a>
    </footer>
  


      </article>
      
      <hr>
      
    
    
      <article>
        
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/09/02/double-clicking-in-ironpython-and-silverlight/">Double Clicking in IronPython + Silverlight</a></h1>
    
    
      <p class="meta">
        








  


<i class="fa fa-calendar-o"></i> <time datetime="2009-09-02T00:00:00-04:00" pubdate data-updated="true">September  2, 2009</time> 
        
           | <a href="/blog/2009/09/02/double-clicking-in-ironpython-and-silverlight/#disqus_thread"
             data-disqus-identifier="http://blog.evilmonkeylabs.com/blog/2009/09/02/double-clicking-in-ironpython-and-silverlight/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Silverlight rather oddly lacks a double click event.  You can detect single click, but for double clicking you&rsquo;re on your own.  I found some examples for C#, but none for IronPython and had, a few months ago, ported some code I found <a href="http://shemesh.wordpress.com/2009/03/05/silverlight-attach-a-double-click-to-any-object/">here</a> for IronPython.</p>

<p>I&rsquo;ve been using it in application development and user testing for about 6 months and it works fairly well in both Silverlight 2 and 3, although YMMV.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">CLICK_INTERVAL</span> <span class="o">=</span> <span class="mi">500</span>
 
<span class="k">class</span> <span class="nc">ClickHandler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attach a Double Click handler to any given UIElement,</span>
<span class="sd">    as by default Silverlight lacks support for double clicking.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_lastClickTime</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_callback</span> <span class="o">=</span> <span class="bp">None</span>
 
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">attachDoubleClickHandler</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ClickHandler</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
 
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="n">target</span><span class="o">.</span><span class="n">MouseLeftButtonUp</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_MouseLeftButtonUp</span>
        <span class="n">target</span><span class="o">.</span><span class="n">MouseLeftButtonDown</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_MouseLeftButtonDown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
 
    <span class="k">def</span> <span class="nf">target_MouseLeftButtonUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastClickTime</span> <span class="o">=</span> <span class="n">DateTime</span><span class="o">.</span><span class="n">Now</span><span class="o">.</span><span class="n">Ticks</span> <span class="o">/</span> <span class="mi">10000</span>
 
    <span class="k">def</span> <span class="nf">target_MouseLeftButtonDown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">DateTime</span><span class="o">.</span><span class="n">Now</span><span class="o">.</span><span class="n">Ticks</span> <span class="o">/</span> <span class="mi">10000</span>
        <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastClickTime</span> <span class="o">&lt;</span> <span class="n">CLICK_INTERVAL</span> <span class="ow">and</span> \
          <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastClickTime</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></code></pre></div>


<p>You may want to tweak the click interval based on what works for you.  500 milliseconds worked well with my users, for the application in question. To attach a ClickHandler simply invoke the static method <code>ClickHandler.attachDoubleClickHandler(«uiElementObj», «callbackFunc»)</code></p>

</div>
  
  
    <footer>
      <a rel="full-article" class="button tiny radius" href="/blog/2009/09/02/double-clicking-in-ironpython-and-silverlight/">Read on &rarr;</a>
    </footer>
  


      </article>
      
    
    <div class="pagination">
      

      
      <a class="next" href="1">Newer &rarr;</a>
      
    </div>
  </div>
</div>
  
  <aside class="sidebar small-12 medium-12 large-4 columns">
    
      <section>
  <h1>Recent Posts <i class="fa fa-edit"></i></h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/03/23/Pickling_Case_Classes_to_Memcached/">Pickling Case Classes to Memcached With Scala</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/17/Distributing_Akka_Workloads_And_Shutting_Down_After/">Distributing Akka Workloads - and Shutting Down Afterwards</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/11/Understanding_Scala_Type_Classes/">Understanding Scala&#8217;s Type Classes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/31/Forcing_Compiler_Nothing_checks/">Forcing Scala Compiler &#8216;Nothing&#8217; Checks</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/29/Casbah2.3_Released/">Casbah 2.3.0-RC1 Released</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos <i class="fa fa-github"></i></h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/bwmcadams">@bwmcadams</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'bwmcadams',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





    
  </aside>
  

    </div>
  </div>
  <footer role="contentinfo"><p class="text-center">
  <span class="copyright">
  	Copyright &copy; 2015 by Brendan McAdams
  </span>

  <span class="credit">
  	Powered by <a href="http://octopress.org" target="_blank">Octopress</a><br />
  	<span><a href="http://github.com/annejohnson/octofound" target="_blank">Theme</a> by <a href="http://feathers.io" target="_blank">Anne Johnson</a></span>
  </span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'evilmonkeyblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>






</body>
</html>
