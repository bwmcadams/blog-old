<!DOCTYPE html>

<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Talking to ActiveDirectory from IronPython</title>
  
  
  <link href="http://blog.evilmonkeylabs.com" rel="alternate" title="Evil Monkey Labs" type="application/atom+xml" />
  <link rel="openid.delegate" href="http://evilmonkeylabs.myopenid.com" />

  <link rel="stylesheet" href="/stylesheets/application.css" type="text/css" />
  <link rel="stylesheet" href="/stylesheets/evilmonkey.css" type="text/css" />
</head>

<body>
<div id="container">
  <div id="logo">
    <img src="/images/logo_small.png" alt="Evil Monkey Logo"/>
  </div>
  <div id="header">
    <h1><span><a href="/">Evil Monkey Labs</a></span></h1>
    <h2>Code and related ramblings.</h2>
  </div>

  <div id="page">
    <div id="content">
      <div class="hentry" id="/2009/10/20/talking-to-activedirectory-from-iron-python">
  <h2 class="entry-title">
    <a href="/2009/10/20/talking-to-activedirectory-from-iron-python/">Talking to ActiveDirectory from IronPython</a>
  </h2>
  
  <abbr class="published" title="2009-10-20T00:00:00+00:00">20 Oct 2009</abbr>
  <br class="clear" />
  <div class="entry-content">
    <p>We're building a new intranet system at work, and I've been toying with a few things that the Windows admin asked for.  Namely, since the secretaries here will update the intranet data to add people's Work &amp; Emergency contact numbers, AIM handles, email addresses, etc. that we find a way to keep it all in sync with ActiveDirectory.  Thereby keeping all the Outlooks  and Blackberries up to date with the latest contact information.</p>

<p>This seemed like a fairly reasonable request, presuming we could figure out how to do it and since I've been using Mono and IronPython a lot more lately, I figured there would be a way to accomplish it.  Most of the information I found online was either really old and/or crappy docs for doing it in C#, or more commonly using PowerShell or VBScript.  So, I managed to poke around and sort out how to get IronPython on Mono (IronPython 2.6RC + Mono 2.4.2.3) to find and update our users.</p>

<p>The end result is that I can now, from IronPython, find and update valid information on ActiveDirectory entries to reflect the latest and greatest information.  One thing to note, the MS .Net ActiveDirectory APIs (System.DirectoryServices, which is mirrored in Mono) do something that confused and annoyed me.  There are a limited set of 'valid' attribute keys for a user object in Active Directory (Which is really just LDAP, in case you didn't know).  The <code>DirectoryEntry</code> object has a Properties attribute, which contains a hashmap of these values.</p>

<!--more-->


<p>The object will <strong>not</strong> allow you to set an "Invalid" key (see <a href="http://www.dotnetactivedirectory.com/Understanding_LDAP_Active_Directory_User_Object_Properties.html">this list</a> for valid keys).  But if you call <code>.Properties.Keys</code> you <em>only</em> get back the Properties that have values set.  So, it doesn't appear to be possible to actually ask <em>What keys are valid?</em> and do some introspective programming.  I have written a wrapper class to make the DirectoryEntry properties look a bit more pythonic (but disabled support for multi-value attributes for now) - at some point in the near future i'll likely add in a "valid value" filter.</p>

<p>The end result is, if I want to find my own user in ActiveDirectory by my name, I can do the following from the IronPython console:</p>

<div class="highlight"><pre><code class="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ad_util</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">adh</span> <span class="o">=</span> <span class="n">ad_util</span><span class="o">.</span><span class="n">ActiveDirectorySearcher</span><span class="p">(</span><span class="s">&#39;mydomaincontroller.hostname.or.ip&#39;</span><span class="p">,</span> <span class="s">&#39;my.domain&#39;</span><span class="p">,</span> <span class="s">&#39;myUsernameAllowedToChangeObjects&#39;</span><span class="p">,</span> <span class="s">&#39;myPassword&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">adh</span>
<span class="o">&lt;</span><span class="n">ActiveDirectorySearcher</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x000000000000002D</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">userObj</span> <span class="o">=</span> <span class="n">adh</span><span class="o">.</span><span class="n">find_name</span><span class="p">(</span><span class="s">&#39;McAdams&#39;</span><span class="p">,</span> <span class="s">&#39;Brendan&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">debug</span><span class="p">]</span> <span class="n">Searching</span> <span class="n">activedirectory</span> <span class="k">for</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;(</span><span class="n">objectCategory</span><span class="o">=</span><span class="n">user</span><span class="p">)(</span><span class="n">objectClass</span><span class="o">=</span><span class="n">person</span><span class="p">)(</span><span class="n">sAMAccountName</span><span class="o">=*</span><span class="p">)(</span><span class="n">sn</span><span class="o">=</span><span class="n">McAdams</span><span class="o">*</span><span class="p">)</span>
<span class="p">(</span><span class="n">givenname</span><span class="o">=</span><span class="n">Brendan</span><span class="o">*</span><span class="p">))</span><span class="o">.</span>  <span class="n">Allow</span> <span class="n">multiple</span> <span class="n">results</span><span class="err">?</span> <span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">userObj</span>
<span class="o">&lt;</span><span class="n">DirectoryEntryHelper</span><span class="p">:{</span><span class="n">sn</span><span class="o">=</span><span class="n">McAdams</span><span class="p">,</span><span class="n">givenName</span><span class="o">=</span><span class="n">Brendan</span><span class="p">,</span><span class="n">mail</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">sAMAccountName</span><span class="o">=</span><span class="n">brendan</span><span class="o">.</span><span class="n">mcadams</span><span class="p">}</span><span class="o">&gt;</span>
</code></pre>
</div>


<p>You'll note the object returned is a "DirectoryEntryHelper" type; this is a crappy little wrapper class I put together to simplify attribute access, etc.   You can tell any of the find_ methods to return a raw .Net API object instead of wrapped by passing the kwarg <code>nowrap=True</code>;  <code>find_name()</code> takes <code>last_name, first_name</code>.  Several other utility methods exist on the class including find by account name.  Note that, in order to filter out entries in the Global Address List I'm requiring the search to find objects who have sAMAccountNames. I know the bare minimum about ActiveDirectory, but my Windows admin here tells me that sAMAccountName is a required and <em>unique</em> attribute on any actual domain account object.</p>

<p>You can see the keys that are already defined on the object with the <code>keys</code> helper method I added onto <code>DirectoryEntryHelper</code>:</p>

<div class="highlight"><pre><code class="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">userObj</span><span class="o">.</span><span class="n">keys</span>
<span class="p">[</span><span class="s">&#39;lockouttime&#39;</span><span class="p">,</span> <span class="s">&#39;primarygroupid&#39;</span><span class="p">,</span> <span class="s">&#39;msexchuseraccountcontrol&#39;</span><span class="p">,</span> <span class="s">&#39;distinguishedname&#39;</span><span class="p">,</span> <span class="s">&#39;cn&#39;</span><span class="p">,</span> <span class="s">&#39;dscorepropagationdata&#39;</span><span class="p">,</span> 
<span class="s">&#39;whencreated&#39;</span><span class="p">,</span> <span class="s">&#39;logoncount&#39;</span><span class="p">,</span> <span class="s">&#39;msexchhomeservername&#39;</span><span class="p">,</span> <span class="s">&#39;objectclass&#39;</span><span class="p">,</span> <span class="s">&#39;memberof&#39;</span><span class="p">,</span> <span class="s">&#39;lastlogontimestamp&#39;</span><span class="p">,</span> <span class="s">&#39;displayname&#39;</span><span class="p">,</span>    <span class="s">&#39;msexchalobjectversion&#39;</span><span class="p">,</span> <span class="s">&#39;objectguid&#39;</span><span class="p">,</span> <span class="s">&#39;whenchanged&#39;</span><span class="p">,</span> <span class="s">&#39;badpwdcount&#39;</span><span class="p">,</span> <span class="s">&#39;useraccountcontrol&#39;</span><span class="p">,</span> <span class="s">&#39;badpasswordtime&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> 
<span class="s">&#39;samaccountname&#39;</span><span class="p">,</span> <span class="s">&#39;mdbusedefaults&#39;</span><span class="p">,</span> <span class="s">&#39;accountexpires&#39;</span><span class="p">,</span> <span class="s">&#39;countrycode&#39;</span><span class="p">,</span> <span class="s">&#39;msds-supportedencryptiontypes&#39;</span><span class="p">,</span> <span class="s">&#39;homedirectory&#39;</span><span class="p">,</span> 
<span class="s">&#39;userprincipalname&#39;</span><span class="p">,</span> <span class="s">&#39;lastlogon&#39;</span><span class="p">,</span> <span class="s">&#39;objectsid&#39;</span><span class="p">,</span> <span class="s">&#39;givenname&#39;</span><span class="p">,</span> <span class="s">&#39;homedrive&#39;</span><span class="p">,</span> <span class="s">&#39;usncreated&#39;</span><span class="p">,</span> <span class="s">&#39;admincount&#39;</span><span class="p">,</span> <span class="s">&#39;instancetype&#39;</span><span class="p">,</span> 
<span class="s">&#39;codepage&#39;</span><span class="p">,</span> <span class="s">&#39;physicaldeliveryofficename&#39;</span><span class="p">,</span> <span class="s">&#39;samaccounttype&#39;</span><span class="p">,</span> <span class="s">&#39;sn&#39;</span><span class="p">,</span> <span class="s">&#39;objectcategory&#39;</span><span class="p">,</span> <span class="s">&#39;telephonenumber&#39;</span><span class="p">,</span> <span class="s">&#39;pwdlastset&#39;</span><span class="p">,</span> 
<span class="s">&#39;usnchanged&#39;</span><span class="p">,</span> <span class="s">&#39;lastlogoff&#39;</span><span class="p">,</span> <span class="s">&#39;initials&#39;</span><span class="p">]</span>
</code></pre>
</div>


<p>This returns a comprehended list of the keys (Rather than calling resultObj.Properties.Keys, which returns a Hashtable of HashKeys.  It just makes life easier.</p>

<p>If I want to setup my mobile phone # (which isn't already set already) in Active Directory:</p>

<div class="highlight"><pre><code class="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">userObj</span><span class="o">.</span><span class="n">mobile</span>
<span class="c"># Nothing returned as mobile isn&#39;t set...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">userObj</span><span class="o">.</span><span class="n">mobile</span> <span class="o">=</span> <span class="s">&#39;(646) 555-1212&#39;</span>
<span class="c"># It is committed on set to Active Directory, so another find gets it...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">newUserObj</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">adh</span><span class="o">.</span><span class="n">find_name</span><span class="p">(</span><span class="s">&#39;McAdams&#39;</span><span class="p">,</span> <span class="s">&#39;Brendan&#39;</span><span class="p">)</span>   
<span class="p">[</span><span class="n">debug</span><span class="p">]</span> <span class="n">Searching</span> <span class="n">activedirectory</span> <span class="k">for</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;(</span><span class="n">objectCategory</span><span class="o">=</span><span class="n">user</span><span class="p">)(</span><span class="n">objectClass</span><span class="o">=</span><span class="n">person</span><span class="p">)(</span><span class="n">sAMAccountName</span><span class="o">=*</span><span class="p">)(</span><span class="n">sn</span><span class="o">=</span><span class="n">McAdams</span><span class="o">*</span><span class="p">)</span>
<span class="p">(</span><span class="n">givenname</span><span class="o">=</span><span class="n">Brendan</span><span class="o">*</span><span class="p">))</span><span class="o">.</span>  <span class="n">Allow</span> <span class="n">multiple</span> <span class="n">results</span><span class="err">?</span> <span class="bp">False</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">newUserObj</span><span class="o">.</span><span class="n">mobile</span>
<span class="s">&#39;(646)555-1212&#39;</span>
</code></pre>
</div>


<p>I'll leave the rest as an exercise for the reader, but I'm interested in comments and changes.  You can fetch the latest code from <a href="http://bitbucket.org/bwmcadams/toybox/src/tip/ad_util.py">my BitBucket toybox</a>.  I've also pasted it, for posterity sake, below the fold.</p>

<div class="highlight"><pre><code class="python"><span class="c">#!IronPython Specific Script!</span>
<span class="c"># </span>
<span class="c"># Brendan W. McAdams &lt;bwmcadams@gmail.com&gt;</span>
<span class="c">#</span>
<span class="c">#------------------------------------------------- </span>
<span class="c"># No copyright or licensing, made public</span>
<span class="c"># as example code.  Feel free to use it as you like;</span>
<span class="c"># No warranty, liability or guarantees are implied.  </span>
<span class="c"># In other words, if you use it YOU ARE ON YOUR OWN. </span>
<span class="c">#-------------------------------------------------</span>
<span class="c">#</span>
<span class="c"># Utility script to interface from IronPython to </span>
<span class="c"># MS Active Directory, allowing queries of properties </span>
<span class="c"># such as telephone numbers, and changes to said properties</span>
<span class="c"># if you&#39;d like to update them.</span>
<span class="c"># </span>
<span class="c"># Note that your authentication user has to have valid permissions.</span>
<span class="c"># If you&#39;re uncertain as to what permissions are needed, please see</span>
<span class="c"># your AD Admin.</span>

<span class="kn">import</span> <span class="nn">clr</span> 

<span class="c"># Add the System.DirectoryServices Mono DLL in.</span>
<span class="c"># not sure on Windows what you need to add,</span>
<span class="c"># but for Mono/Linux you just need to set IRONPYTHONPATH</span>
<span class="c"># to include the location of the dll</span>

<span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s">&#39;System.DirectoryServices.dll&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># Import the LDAP / ActiveDirectory interface</span>
<span class="kn">from</span> <span class="nn">System.DirectoryServices</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># A few predefined values to simplify LDAP querying, pilfered from various internet-ey type places.</span>
<span class="n">BINARY_PROPS</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;objectguid&#39;</span><span class="p">,</span> <span class="s">&#39;objectsid&#39;</span><span class="p">,</span> <span class="s">&#39;msexchmailboxsecuritydescriptor&#39;</span><span class="p">,</span> <span class="s">&#39;msexchmailboxguid&#39;</span><span class="p">)</span>
<span class="n">ACCOUNT_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=user)(objectClass=person)(sAMAccountName=_ACCOUNTNAME_))&quot;</span>
<span class="n">PRINCIPAL_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=user)(objectClass=person)(userPrincipalName=_PRINCIPALID__))&quot;</span>
<span class="n">GROUP_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=group)(sAMAccountName=_GROUPNAME_))&quot;</span>
<span class="n">PARTIAL_LAST_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=user)(sAMAccountName=*)(objectClass=person)(sn=_LASTNAME_*))&quot;</span> 
<span class="n">PARTIAL_NAME_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=user)(objectClass=person)(sAMAccountName=*)(sn=_LASTNAME_*)(givenname=_FIRSTNAME_*))&quot;</span> 
<span class="n">PARTIAL_FIRST_QUERY</span> <span class="o">=</span> <span class="s">&quot;(&amp;amp;(objectCategory=user)(objectClass=person)(sAMAccountName=*)(givenname=_FIRSTNAME_*))&quot;</span> 



<span class="k">class</span> <span class="nc">DirectoryEntryHelper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Helper class for wrapping</span>
<span class="sd">  and simplifying AD search results.</span>
<span class="sd">  As much fun as dealing with Microsoft style</span>
<span class="sd">  object hierarchies can be...</span>
<span class="sd">  TODO: Is there an easy way to inject things into __dict__ for dir &amp;amp; ipy tab completion?</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">SearchResult</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;_entry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">GetDirectoryEntry</span><span class="p">()</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">DirectoryEntry</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;_entry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="s">&quot;Invalid type &#39;</span><span class="si">%s</span><span class="s">&#39;, don&#39;t know how to proxy it&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Returns a comprehended list</span>
<span class="sd">      of the *defined* Keys on the Properties object.</span>
<span class="sd">      Any valid keys w/o values won&#39;t get listed.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">Keys</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Proxies the Properties objects in the DirectoryEntry</span>
<span class="sd">      to provide a simple getter.</span>
<span class="sd">      First checks if DirectoryEntry has an attribute (property)</span>
<span class="sd">      matching requested key, and passes that if so.</span>
<span class="sd">      Otherwise, fetches a matching property.  If you have</span>
<span class="sd">      a name collison, use the .properties property on this object</span>
<span class="sd">      to get a clean copy of the Properties object</span>
<span class="sd">      TODO: Better support for multi-value keys (only returns first idx right now]</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
          <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">Count</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Proxies the Properties objects in the DirectoryEntry </span>
<span class="sd">      to provide a simpler setter.</span>
<span class="sd">      First checks if DirectoryEntry has an attribute (property)</span>
<span class="sd">      matching requested key, and sets on that if so.</span>
<span class="sd">      Otherwise, sets upon a matching property.  </span>
<span class="sd">      If the property has an existing count &gt; 0, sets Index 0  </span>
<span class="sd">      If not, it does an Add().</span>
<span class="sd">      The way the MS Classes work, Properties.Keys only returns keys that</span>
<span class="sd">      have a value count.  However, any *valid* Key has a silent value which</span>
<span class="sd">      can be initialized via Add().</span>
<span class="sd">      Invalid keys throw an error, so you can&#39;t be arbitrary.</span>
<span class="sd">      I use a list of keyspace found at: </span>

<span class="sd">          http://www.dotnetactivedirectory.com/\</span>
<span class="sd">              Understanding_LDAP_Active_Directory_User_Object_Properties.html</span>

<span class="sd">      If you have a name collison, use the .properties property on this object</span>
<span class="sd">      to get a clean copy of the Properties object</span>
<span class="sd">      TODO: Better support for multi-value keys (only sets first idx right now]</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
          <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
              <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                  <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;[warning] Key &#39;</span><span class="si">%s</span><span class="s">&#39; contains multiple values which we don&#39;t properly support yet.  Using Index 0&quot;</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">Properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
          <span class="c"># commit early, commit often...</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_entry</span><span class="o">.</span><span class="n">CommitChanges</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Print all pretty like on console.</span>
<span class="sd">      My biggest pet peeve working in .Net is that most objects don&#39;t have</span>
<span class="sd">      any kind of __str__/__repr__ value on them to give you quick information</span>
<span class="sd">      on their contents.  ARGH!</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s">&quot;&lt;DirectoryEntryHelper:{sn=</span><span class="si">%s</span><span class="s">,givenName=</span><span class="si">%s</span><span class="s">,mail=</span><span class="si">%s</span><span class="s">,sAMAccountName=</span><span class="si">%s</span><span class="s">}&gt;&quot;</span> <span class="o">%</span>\
          <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">givenName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mail</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sAMAccountName</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ActiveDirectory</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; ActiveDirectory interface class.</span>
<span class="sd">  Tested on IronPython 2.6RC + Mono 2.4.2.3 on Linux. YMMV.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c"># Active Directory Handle</span>
  <span class="n">adh</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="n">server</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="n">domain</span> <span class="o">=</span> <span class="bp">None</span>
  <span class="n">baseDN</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">baseDN</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Constructor to instantiate the LDAP connection.</span>
<span class="sd">      server is a resolvable address to your domain controller (e.g. the resolvable hostname or IP)</span>
<span class="sd">      domain should be the ActiveDirectory domain as specified by your admin.</span>
<span class="sd">      If you don&#39;t pass BaseDN, your &#39;domain&#39; argument will be split on</span>
<span class="sd">      . and each piece will be passed as DC=&lt;piece&gt;. This will be used as your BaseDN</span>
<span class="sd">      E.G. domain aurigasv.local becomes &quot;DC=aurigasv,DC=local&quot;</span>

<span class="sd">      *** Any exception in connecting will be wrapped and rethrown, aborting construction.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">try</span><span class="p">:</span>
          <span class="c"># Setup the baseDN</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">server</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>
          <span class="k">if</span> <span class="n">baseDN</span><span class="p">:</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">baseDN</span> <span class="o">=</span> <span class="n">baseDN</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">for</span> <span class="n">tier</span> <span class="ow">in</span> <span class="n">domain</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">):</span>
                  <span class="n">baseDN</span> <span class="o">+=</span> <span class="s">&quot;DC=</span><span class="si">%s</span><span class="s">,&quot;</span> <span class="o">%</span> <span class="n">tier</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">baseDN</span> <span class="o">=</span> <span class="n">baseDN</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
              <span class="c">#print &quot;Established a parsed BaseDN of &#39;%s&#39;&quot; % self.baseDN</span>

          <span class="c"># Establish a directory object, with auth info, pointing at the authenticating user</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">adh</span> <span class="o">=</span> <span class="n">DirectoryEntry</span><span class="p">(</span><span class="s">&quot;LDAP://</span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseDN</span><span class="p">))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">adh</span><span class="o">.</span><span class="n">AuthenticationType</span> <span class="o">=</span> <span class="n">AuthenticationTypes</span><span class="o">.</span><span class="n">Secure</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">adh</span><span class="o">.</span><span class="n">Username</span> <span class="o">=</span> <span class="n">username</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">adh</span><span class="o">.</span><span class="n">Password</span> <span class="o">=</span> <span class="n">password</span>

          <span class="c"># connect and fetch a copy of the authenticating user</span>
          <span class="nb">filter</span> <span class="o">=</span> <span class="s">&quot;sAMAccountName=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">username</span>
          <span class="n">dsSystem</span> <span class="o">=</span> <span class="n">DirectorySearcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adh</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
          <span class="n">dsSystem</span><span class="o">.</span><span class="n">SearchScope</span> <span class="o">=</span> <span class="n">SearchScope</span><span class="o">.</span><span class="n">Subtree</span>
          <span class="n">result</span> <span class="o">=</span> <span class="n">dsSystem</span><span class="o">.</span><span class="n">FindOne</span><span class="p">()</span>

          <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
              <span class="k">raise</span> <span class="ne">Exception</span><span class="p">,</span> <span class="s">&quot;Found no result searching for specified authentication user </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">username</span>

      <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
          <span class="k">raise</span> <span class="n">e</span><span class="p">,</span> <span class="s">&quot;Authentication failure.  Did you provide valid connection information / authentication credentials?&quot;</span>

  <span class="k">def</span> <span class="nf">get_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">&quot;__iter__&quot;</span><span class="p">):</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">DirectoryEntryHelper</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">DirectoryEntryHelper</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ActiveDirectorySearcher</span><span class="p">(</span><span class="n">ActiveDirectory</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Semi-private method for searching.</span>
<span class="sd">      Note that &quot;filter&quot; needs to be a string which is a </span>
<span class="sd">      *VALID* LDAP query/filter.  You should probably use one of the useful</span>
<span class="sd">      utility find methods instead of querying this directly</span>
<span class="sd">      unless you understand LDAP queries</span>
<span class="sd">      By default searches for one only, pass multi=True for multiple results.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">print</span> <span class="s">&quot;[debug] Searching activedirectory for </span><span class="si">%s</span><span class="s">.  Allow multiple results? </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="n">multi</span><span class="p">)</span>
      <span class="n">searcher</span> <span class="o">=</span> <span class="n">DirectorySearcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adh</span><span class="p">)</span>

      <span class="n">searcher</span><span class="o">.</span><span class="n">ReferralChasing</span> <span class="o">=</span> <span class="n">ReferralChasingOption</span><span class="o">.</span><span class="n">All</span>
      <span class="n">searcher</span><span class="o">.</span><span class="n">SearchScope</span> <span class="o">=</span> <span class="n">SearchScope</span><span class="o">.</span><span class="n">Subtree</span>
      <span class="n">searcher</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="nb">filter</span>

      <span class="n">results</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="n">FindAll</span><span class="p">()</span>

      <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">Count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">Exception</span><span class="p">,</span> <span class="s">&quot;No results found for search.&quot;</span>

      <span class="k">if</span> <span class="n">multi</span><span class="p">:</span>
          <span class="c"># Generator for performance</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">results</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
              <span class="k">raise</span> <span class="ne">Exception</span><span class="p">,</span> <span class="s">&quot;Found multiple results in single-search mode.  To support multiples, please pass multi=True to the find method.&quot;</span>
          <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  


  <span class="k">def</span> <span class="nf">find_last_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nowrap</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Searches by sn (lastname).</span>
<span class="sd">      This can be a partial query, as long as the first</span>
<span class="sd">      few letters of last_name are defined </span>
<span class="sd">      By default searches for one only, pass multi=True for multiple results.</span>
<span class="sd">      If you want  raw .Net SearchResult(s) object(s), pass nowrap=True, otherwise</span>
<span class="sd">      you get it back wrapped in a helper class.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">(</span><span class="n">PARTIAL_LAST_QUERY</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_LASTNAME_&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="p">),</span> <span class="n">multi</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">nowrap</span><span class="p">:</span>
          <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_helper</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

      <span class="k">return</span> <span class="n">result</span>

  <span class="k">def</span> <span class="nf">find_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">first_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nowrap</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Searches by sn (lastname) &amp;amp; givenName( firstname) </span>
<span class="sd">      This can be a partial query, as long as the first</span>
<span class="sd">      few letters of last_name are defined</span>
<span class="sd">      If firstname is None, it quietly passes into find_last_name.</span>
<span class="sd">      By default searches for one only, pass multi=True for multiple results.</span>
<span class="sd">      If you want  raw .Net SearchResult(s) object(s), pass nowrap=True, otherwise</span>
<span class="sd">      you get it back wrapped in a helper class.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">last_name</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">Exception</span><span class="p">,</span> <span class="s">&quot;You must, at a minimum, specify last_name for a name search.&quot;</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">first_name</span><span class="p">:</span>
          <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_last_name</span><span class="p">(</span><span class="n">last_name</span><span class="p">,</span> <span class="n">multi</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">(</span><span class="n">PARTIAL_NAME_QUERY</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_FIRSTNAME_&#39;</span><span class="p">,</span> <span class="n">first_name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_LASTNAME_&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="p">),</span> <span class="n">multi</span><span class="p">)</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">nowrap</span><span class="p">:</span>
              <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_helper</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

      <span class="k">return</span> <span class="n">result</span>

  <span class="k">def</span> <span class="nf">find_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nowrap</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Searches by  sAMAccountName (account_name), which should be unique</span>
<span class="sd">      This can be a partial query, as long as the first</span>
<span class="sd">      few letters of account_name are defined</span>
<span class="sd">      If firstname is None, it quietly passes into find_last_name.</span>
<span class="sd">      By default searches for one only, pass multi=True for multiple results.</span>
<span class="sd">      If you want  raw .Net SearchResult(s) object(s), pass nowrap=True, otherwise</span>
<span class="sd">      you get it back wrapped in a helper class.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">(</span><span class="n">ACCOUNT_QUERY</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_ACCOUNTNAME_&#39;</span><span class="p">,</span> <span class="n">account_name</span><span class="p">),</span> <span class="n">multi</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">nowrap</span><span class="p">:</span>
          <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_helper</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

      <span class="k">return</span> <span class="n">result</span>

  <span class="k">def</span> <span class="nf">find_first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nowrap</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Searches by givenName, which should be unique</span>
<span class="sd">      This can be a partial query, as long as the first</span>
<span class="sd">      few letters of account_name are defined</span>
<span class="sd">      If firstname is None, it quietly passes into find_last_name.</span>
<span class="sd">      By default searches for one only, pass multi=True for multiple results.</span>
<span class="sd">      If you want  raw .Net SearchResult(s) object(s), pass nowrap=True, otherwise</span>
<span class="sd">      you get it back wrapped in a helper class.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">(</span><span class="n">PARTIAL_FIRST_QUERY</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_FIRSTNAME_&#39;</span><span class="p">,</span> <span class="n">first_name</span><span class="p">),</span> <span class="n">multi</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">nowrap</span><span class="p">:</span>
          <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_helper</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

      <span class="k">return</span> <span class="n">result</span>
</code></pre>
</div>




  </div>
  <ul class="meta">
    
    
      <li>Tags: <a rel="tag" href="/tags/#tech">tech</a> <a rel="tag" href="/tags/#IronPython">IronPython</a> <a rel="tag" href="/tags/#Silverlight">Silverlight</a> <a rel="tag" href="/tags/#Python">Python</a> <a rel="tag" href="/tags/#ActiveDirectory">ActiveDirectory</a> <a rel="tag" href="/tags/#LDAP">LDAP</a></li>
    
    <li>Meta:
      <a href="http://blog.evilmonkeylabs.com/2009/10/20/talking-to-activedirectory-from-iron-python/#disqus_thread" rel="bookmark">permalink</a>
      <a href="http://blog.evilmonkeylabs.com">atom</a>
    </li>
  </ul>
  <ul class="posts">
    
    <li><span>Previous: 02 Sep 2009</span> &raquo; <a href="/2009/09/02/double-clicking-in-ironpython-and-silverlight/">Double Clicking in IronPython + Silverlight</a></li>
    
    
    <li><span>    Next: 10 Jan 2011</span> &raquo; <a href="/2011/01/10/intro-scala-mongo/">Exploring Scala with MongoDB</a></li>
    
  </ul>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /**
      * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
      */
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://evilmonkeyblog.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=evilmonkeyblog">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

    </div>

    <div id="sidebar">
      <!-- sidebar components -->
      <div class="sidebar-node">
          <h3 class='sidebar-title'>Blogroll</h3>
          <div class='static-body'>
            <ul>
              <li><a href="http://blog.10gen.com/" title="10gen Blog">The 10Gen Blog on MongoDB and NoSQL</a></li>
              <li><a href="http://snailinaturtleneck.com/blog/" title="Snail In A Turtleneck">Snail In a Turtleneck - Kristina Chodorow (Maintainer of PHP &amp; Perl for MongoDB)</a></li>
              <li><a href="http://kylebanker.com/blog/" title="Hwaet!">Hwaet! - Kyle Banker (Maintainer of Ruby for MongoDB)</a></li>
              <li><a href="http://worldairmaillinks.com" title="World Airmail Links">World Airmail Links</a></li>
            </ul>
         </div>
        <h3 class='sidebar-title'>Projects &amp; Sites I've Worked On</h3>
        <div class='static-body'>
          <ul>
            <li><a href="http://github.com/bwmcadams/" title="GitHub">GitHub Profile</a></li>
            <li><a href="http://mongodb.org/" title="MongoDB">MongoDB</a> 
            <div class="sidebar_tiny">I work fulltime on MongoDB at <a href="http://10gen.com">10gen</a>, maintaining JVM tools such as the <a href="http://github.com/mongodb/mongo-java-driver">Java Driver</a>, <a href="http://github.com/mongodb/casbah">Casbah (Scala Driver)</a> and <a href="http://github.com/mongodb/mongo-hadoop">Hadoop Integration</a>.</div> 
            </li>
            <li><a href="http://api.mongodb.org/scala/casbah/latest/" title="Casbah">Casbah</a> <div class="sidebar_tiny">An open source Scala driver for MongoDB that I created &amp; maintain.</div></li>
            <li><a href="http://sluggy.com/" title="Sluggy Freelance">Sluggy Freelance</a> <div class="sidebar_tiny">(I wrote &amp; maintain the current code running the site. [Python+Pylons+MongoDB])</div></li>
            <li><a href="http://userfriendly.org/" title="UserFriendly">UserFriendly</a> <div class="sidebar_tiny">(Once upon a time I built the CMS which runs their site. [Perl+mod_perl])</div></li>
            <li><a href="http://bitbucket.org/namlook/mongokit/">MongoKit</a> <div class="sidebar_tiny">(I've contributed Pylons support and a few other useful hacks.)</div></li>
          </ul>
        </div>
       
        <h3 class='sidebar-title'>Presentations</h3>
          <div class='static-body'>
            <ul>
                <li>
                    <a href="http://www.10gen.com/video/mongosv2010/coolfeatures">MongoDB Cool Features @ MongoSV 12/10</a>
                </li>
                <li>
                    <a href="http://www.10gen.com/video/mongosv2010/hadoop">The Hadoop Plugin for MongoDB @ MongoSV 12/10</a> 
                </li>
                <li>
                    <a href="http://www.10gen.com/video/mongodc2010/schemadesign">Schema Design with MongoDB @ MongoDC 11/10</a>
                </li>
                <li>
                    MongoDB + Scala @ NY Scala 8/10
                    <ul>
                      <li>
                        <a href="http://www.slideshare.net/bwmcadams/scalany-mongodb-aug10">Slides</a>
                      </li>
                      <li>
                        <a href="http://vimeo.com/14090025">Video</a>
                      </li>
                    </ul>
                </li>
                <li>
                    Migrating Sluggy.com from MySQL to MongoDB @ Mongo NY 5/10
                    <ul>
                      <li>
                        <a href="http://www.scribd.com/doc/31748635/From-MySQL-to-MongoDB-at-Sluggy-com">Slides</a> 
                      </li>
                      <li>
                        <a href="http://blip.tv/file/3704023">Video</a>
                        </li>
                     </ul>
                </li>
           </ul>

          </div>
        
        <h3 class='sidebar-title'>Twitter</h3>
          <div class='static-body' id='twitter_block'>
            <div id="twitter_div">
                <script src="http://widgets.twimg.com/j/2/widget.js"></script>
                <script>
                new TWTR.Widget({
                  version: 2,
                  type: 'profile',
                  rpp: 4,
                  interval: 6000,
                  width: 'auto',
                  height: 300,
                  theme: {
                    shell: {
                      background: '#333333',
                      color: '#ffffff'
                    },
                    tweets: {
                      background: '#000000',
                      color: '#ffffff',
                      links: '#4aed05'
                    }
                  },
                  features: {
                    scrollbar: false,
                    loop: false,
                    live: true,
                    hashtags: true,
                    timestamp: true,
                    avatars: true,
                    behavior: 'all'
                  }
                }).render().setUser('rit').start();
                </script>
          </div>
        </div>
        <h3>Syndicate</h3>
        <ul>
            <li><a href="/atom.xml" title="Articles feed">Articles</a></li>
        </ul>

    <br style="clear:both;" />
  </div>
  </div>
  <div id="footer">
    <hr />
    <p><a href="/">Evil Monkey Labs</a></p>
    <ul>
      <li>made with <a href="http://github.com/vilcans/scribbish-jekyll">scribbish-jekyll</a></li>
    </ul>
    <div id="copyright">
      Copyright &copy; 2009-2011 Brendan W. McAdams.<br>
      <span id="disclaimer">
        Views expressed herein are my own. They in no way reflect the views or opinions of my employer (past, current or future), affiliated projects, publisher, or, in many cases, a sane or rational individual.
      </span>
    </div>
  </div>
</div>
<script type="text/javascript">
var disqus_shortname = 'evilmonkeyblog';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://disqus.com/forums/evilmonkeyblog/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

</body>
</html>
